# ETL Framework with DI and Design Patterns

[![Python](https://img.shields.io/badge/Python-3.9%2B-blue)](https://python.org)
[![SQLAlchemy](https://img.shields.io/badge/SQLAlchemy-2.0-green)](https://sqlalchemy.org)
[![Dependency-Injector](https://img.shields.io/badge/Dependency%20Injector-4.0-red)](https://python-dependency-injector.ets-labs.org)

**–ú–æ—â–Ω—ã–π ETL-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫** –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è, —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π:
- DI-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ üß©
- –ü–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è üé®
- –ú–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç–∏ –∏ —á–∞–Ω–∫–æ–≤ üöÄ
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (Email/Telegram) üìß
- –°–∂–∞—Ç–∏—è –¥–∞–Ω–Ω—ã—Ö (GZip, ZIP –∏ –¥—Ä.) üì¶

## üåü –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **–ì–∏–±–∫–∏–π ETL-–ø–∞–π–ø–ª–∞–π–Ω** —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π PostgreSQL, MySQL (–º–æ–∂–Ω–æ —Ä–∞—Å—à–∏—Ä–∏—Ç—å)
- **5+ —Å—Ç—Ä–∞—Ç–µ–≥–∏–π —ç–∫—Å–ø–æ—Ä—Ç–∞**: CSV, Excel, JSON, Parquet –∏ –¥—Ä.
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏** —á–µ—Ä–µ–∑ DI-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
- **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** –æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –∑–∞–¥–∞—á —á–µ—Ä–µ–∑ Observer-–ø–∞—Ç—Ç–µ—Ä–Ω
- **CLI-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å** –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –∏–∑ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å –ø–æ–≤—Ç–æ—Ä–Ω—ã–º–∏ –ø–æ–ø—ã—Ç–∫–∞–º–∏

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

- **–Ø–∑—ã–∫**: Python 3.9+
- **–ë–î**: PostgreSQL (–ø–æ–¥–¥–µ—Ä–∂–∫–∞ –¥—Ä—É–≥–∏—Ö —á–µ—Ä–µ–∑ SQLAlchemy)
- **DI**: `dependency-injector`
- **–°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è**: `pandas`, `pyarrow`
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: `structlog`/`logging`
- **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: `pytest` (–ø—Ä–∏–º–µ—Ä—ã –≤ —Ç–µ—Å—Ç–∞—Ö)

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞
git clone https://github.com/yourusername/etl-framework.git
cd etl-framework
pip install -r requirements.txt

text

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ .env
DB_USER=postgres
DB_PASSWORD=secret
DB_HOST=localhost
DB_PORT=5432
DB_NAME=mydb

text

### –ü—Ä–∏–º–µ—Ä —á–µ—Ä–µ–∑ CLI
python cli.py
--type postgres
--query sql/sales_report.sql
--format csv
--compression gzip
--send-email

text

### –ü—Ä–∏–º–µ—Ä —á–µ—Ä–µ–∑ Python API
from etl.etl_facade import ETLFacade

facade = ETLFacade(
etl_type='postgres',
sql_path='sql/sales_report.sql',
export_format='parquet',
compression='snappy'
)
facade.run_etl()

text

## üß© –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–¥—É–ª–µ–π

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
1. **ETLBase** - –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–π –∫–ª–∞—Å—Å –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è ETL-–ø—Ä–æ—Ü–µ—Å—Å–æ–≤
2. **PostgresETL** - —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è ETL –¥–ª—è PostgreSQL
3. **UnitOfWork** - –º–µ–Ω–µ–¥–∂–µ—Ä —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –ë–î
4. **SaverStrategy** - —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ —ç–∫—Å–ø–æ—Ä—Ç–∞ –¥–∞–Ω–Ω—ã—Ö (CSV, Excel –∏ –¥—Ä.)
5. **NotificationSubject** - —Å–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (Observer)
6. **DI-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏

### –°—Ö–µ–º–∞ —Ä–∞–±–æ—Ç—ã
graph TD
CLI[CLI –ê—Ä–≥—É–º–µ–Ω—Ç—ã] --> Facade[ETLFacade]
Facade --> ETL[PostgresETL]
ETL --> |–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ| DB[(PostgreSQL)]
ETL --> |–¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è| Transform[Pandas]
ETL --> |–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ| Strategy[CsvSaver/ExcelSaver]
ETL --> |–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è| Notify[Email/Telegram]

text

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã —ç–∫—Å–ø–æ—Ä—Ç–∞
| –§–æ—Ä–º–∞—Ç   | –°–∂–∞—Ç–∏–µ              | –ß–∞–Ω–∫–∏ |
|----------|---------------------|-------|
| CSV      | GZIP, ZIP, ZSTD     | ‚úÖ    |
| Excel    | ‚ùå                  | ‚úÖ    |
| JSON     | GZIP, BZ2, LZMA     | ‚úÖ    |
| Parquet  | SNAPPY, GZIP, BROTLI| ‚úÖ    |

### –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
from modules.notifications import NotificationSubject, Observer

class SlackObserver(Observer):
def update(self, message: str, **kwargs):
...

subject = NotificationSubject()
subject.attach(SlackObserver())

text

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ ETL
1. –°–æ–∑–¥–∞—Ç—å –∫–ª–∞—Å—Å –≤ `etl/etl_mysql.py` —É–Ω–∞—Å–ª–µ–¥–æ–≤–∞–≤ –æ—Ç ETLBase
2. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ `etl_registry.py`
etl_registry.py
from etl.etl_mysql import MySQLETL

ETL_MAP = {
'postgres': PostgresETL,
'mysql': MySQLETL # <-- –ù–æ–≤–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
}

text

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è
MIT License. –ü–æ–¥—Ä–æ–±–Ω–µ–µ –≤ —Ñ–∞–π–ª–µ [LICENSE](LICENSE).

---

**–†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–æ —Å ‚ù§Ô∏è –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏**
[–°–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤—É–π—Ç–µ, —Ä–∞—Å—à–∏—Ä—è–π—Ç–µ, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ!](https://github.com/yourusername/etl-framework/issues)